import{r as o,p,h as M,c as f,o as n,w,b as h,a as t,u as r,j as R,k as m,v as T,q as k,l as j,d,e as i,F as C,g as V,f as E,t as P}from"./app-qTUligYE.js";import{A as q,D as J,N as O,T as F}from"./index-DIvpFQje.js";import{_ as Z}from"./DashLayout-QWndDZWM.js";import"./logo-CL_3b9da.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"flex flex-col h-full"},K={class:"bg-white rounded-lg shadow p-4 mb-6"},W={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},G={class:"md:col-span-2"},Q={class:"flex space-x-4"},X={class:"inline-flex items-center"},Y={class:"inline-flex items-center"},ee={class:"inline-flex items-center"},te={class:"flex-1 bg-white rounded-lg shadow overflow-hidden"},se={class:"h-full w-full relative"},ae={key:0,class:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center z-10"},le={class:"absolute bottom-4 left-4 bg-white p-3 rounded-md shadow-md z-10"},ne={key:0,class:"flex items-center mb-2"},oe={key:1,class:"flex items-center mb-2"},re={key:2,class:"flex items-center"},ie={class:"mt-4 flex justify-end"},pe={__name:"index",props:{initialAlerts:Array,initialIncidents:Array,defaultCenter:Object},setup(z){const v=z,I="AIzaSyCze3Rf8MLdkVJeRk207bfNJ6tqs41WLhU",b=o(!1),u=o("7d"),x=o(5),c=o(!0),_=o(v.defaultCenter||{lat:0,lng:0}),N=o(!1),a=o({alerts:!0,incidents:!1,combined:!0}),B=o(v.initialAlerts),S=o(v.initialIncidents),D=p(()=>{const l=A(u.value);return B.value.filter(e=>new Date(e.created_at)>=l)}),L=p(()=>{const l=A(u.value);return S.value.filter(e=>new Date(e.created_at)>=l)}),g=p(()=>{const l=[];return a.value.alerts&&D.value.forEach(e=>{l.push({location:new google.maps.LatLng(parseFloat(e.lat),parseFloat(e.lng)),weight:1})}),a.value.incidents&&L.value.forEach(e=>{l.push({location:new google.maps.LatLng(parseFloat(e.lat),parseFloat(e.lng)),weight:2})}),l}),U=p(()=>({radius:x.value*5,opacity:.6,gradient:["rgba(0, 255, 255, 0)","rgba(0, 255, 255, 1)","rgba(0, 191, 255, 1)","rgba(0, 127, 255, 1)","rgba(0, 63, 255, 1)","rgba(0, 0, 255, 1)","rgba(0, 0, 223, 1)","rgba(0, 0, 191, 1)","rgba(0, 0, 159, 1)","rgba(0, 0, 127, 1)","rgba(63, 0, 91, 1)","rgba(127, 0, 63, 1)","rgba(191, 0, 31, 1)","rgba(255, 0, 0, 1)"]}));function A(l){const e=new Date;switch(l){case"24h":return new Date(e.setDate(e.getDate()-1));case"7d":return new Date(e.setDate(e.getDate()-7));case"30d":return new Date(e.setDate(e.getDate()-30));default:return new Date(0)}}function H(l){if(N.value=!0,g.value.length>0){const e=new google.maps.LatLngBounds;g.value.forEach(s=>e.extend(s.location)),l.fitBounds(e)}}return M([u,a],async()=>{b.value=!0,b.value=!1},{deep:!0}),(l,e)=>(n(),f(Z,null,{default:w(()=>[h(r(R),{title:"Danger Zones"}),t("div",$,[e[18]||(e[18]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-800"},"Danger Zones"),t("p",{class:"mt-1 text-sm text-gray-600"},"Visualize high-risk areas based on recent activity")],-1)),t("div",K,[t("div",W,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date Range",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm"},e[6]||(e[6]=[t("option",{value:"24h"},"Last 24 Hours",-1),t("option",{value:"7d"},"Last 7 Days",-1),t("option",{value:"30d"},"Last 30 Days",-1),t("option",{value:"all"},"All Time",-1)]),512),[[T,u.value]])]),t("div",G,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Heatmap Layers",-1)),t("div",Q,[t("label",X,[m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.alerts=s),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-red-600 focus:ring-red-500"},null,512),[[k,a.value.alerts]]),e[8]||(e[8]=t("span",{class:"ml-2 text-sm text-gray-700"},"Alerts",-1))]),t("label",Y,[m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.incidents=s),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,512),[[k,a.value.incidents]]),e[9]||(e[9]=t("span",{class:"ml-2 text-sm text-gray-700"},"Incidents",-1))]),t("label",ee,[m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.combined=s),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"},null,512),[[k,a.value.combined]]),e[10]||(e[10]=t("span",{class:"ml-2 text-sm text-gray-700"},"Combined",-1))])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Heatmap Intensity",-1)),m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s),type:"range",min:"1",max:"10",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[j,x.value]])])])]),t("div",te,[t("div",se,[b.value?(n(),d("div",ae,e[13]||(e[13]=[t("div",{class:"text-center"},[t("i",{class:"fas fa-circle-notch fa-spin text-3xl text-red-600 mb-2"}),t("p",{class:"text-sm text-gray-600"},"Loading danger zone data...")],-1)]))):i("",!0),h(r(q),{"api-key":r(I),style:{width:"100%",height:"100%"},center:_.value,zoom:12,onLoaded:H},{default:w(()=>[g.value.length>0?(n(),f(r(J),{key:0,data:g.value,options:U.value},null,8,["data","options"])):i("",!0),h(r(O),null,{default:w(()=>[a.value.alerts&&c.value?(n(!0),d(C,{key:0},V(D.value,(s,y)=>(n(),f(r(F),{key:"alert-"+y,options:{position:{lat:parseFloat(s.lat),lng:parseFloat(s.lng)},icon:{url:"https://maps.google.com/mapfiles/ms/icons/red-dot.png",scaledSize:{width:24,height:24}}}},null,8,["options"]))),128)):i("",!0),a.value.incidents&&c.value?(n(!0),d(C,{key:1},V(L.value,(s,y)=>(n(),f(r(F),{key:"incident-"+y,options:{position:{lat:parseFloat(s.lat),lng:parseFloat(s.lng)},icon:{url:"https://maps.google.com/mapfiles/ms/icons/blue-dot.png",scaledSize:{width:24,height:24}}}},null,8,["options"]))),128)):i("",!0)]),_:1}),t("div",le,[a.value.alerts?(n(),d("div",ne,e[14]||(e[14]=[t("div",{class:"w-4 h-4 bg-red-500 rounded-full mr-2"},null,-1),t("span",{class:"text-xs"},"Alerts",-1)]))):i("",!0),a.value.incidents?(n(),d("div",oe,e[15]||(e[15]=[t("div",{class:"w-4 h-4 bg-blue-500 rounded-full mr-2"},null,-1),t("span",{class:"text-xs"},"Incidents",-1)]))):i("",!0),a.value.combined?(n(),d("div",re,e[16]||(e[16]=[t("div",{class:"w-4 h-4 bg-purple-500 rounded-full mr-2"},null,-1),t("span",{class:"text-xs"},"Combined Hotspots",-1)]))):i("",!0)])]),_:1},8,["api-key","center"])])]),t("div",ie,[t("button",{onClick:e[5]||(e[5]=s=>c.value=!c.value),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},[e[17]||(e[17]=t("i",{class:"fas fa-map-marker-alt mr-2"},null,-1)),E(" "+P(c.value?"Hide Individual Points":"Show Individual Points"),1)])])])]),_:1}))}};export{pe as default};
