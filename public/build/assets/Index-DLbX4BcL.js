import{r as _,p as W,h as E,c as D,o as n,w as u,b as i,a as e,u as m,j as J,S as k,f as g,k as f,l as S,d as c,F as x,g as y,t as a,v as I,e as Z,n as A,W as v}from"./app-Dgtfbg1u.js";import{A as q,T as K,Z as G}from"./index-3TkUqxE7.js";import{_ as H}from"./DashLayout-BOSY-Fsh.js";import{_ as Q}from"./ConfirmationModal-BVPsSkgJ.js";import{_ as w}from"./StatCard-6JXp1g-v.js";import"./logo-CL_3b9da.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-Bz_5xRiF.js";const X={class:"space-y-6"},Y={class:"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4"},ee={class:"bg-white rounded-lg shadow p-4"},te={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},se=["value"],oe=["value"],le={class:"flex space-x-2"},ae={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},re={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ne={class:"lg:col-span-1 bg-white rounded-lg shadow overflow-hidden"},de={class:"h-96"},ie={class:"text-sm"},ue={class:"font-medium"},ce={class:"text-gray-600"},me={class:"text-xs mt-1"},ge={class:"lg:col-span-2 bg-white rounded-lg shadow overflow-hidden"},pe={class:"overflow-x-auto"},fe={class:"min-w-full divide-y divide-gray-200"},xe={class:"bg-white divide-y divide-gray-200"},ye={key:0},ve={class:"px-6 py-4 whitespace-nowrap"},be={class:"flex items-center"},he={class:"flex-shrink-0 h-10 w-10 rounded-full bg-red-100 flex items-center justify-center"},we={class:"ml-4"},_e={class:"text-sm font-medium text-gray-900"},ke={class:"text-sm text-gray-500 truncate max-w-xs"},Se={class:"px-6 py-4 whitespace-nowrap"},Ie={class:"text-sm text-gray-900 capitalize"},Ce={class:"text-sm text-gray-500"},Te={class:"px-6 py-4 whitespace-nowrap"},Ve=["onUpdate:modelValue","onChange"],De=["value"],Ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},je={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Re=["onClick"],Ue={class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6 flex flex-col sm:flex-row items-center justify-between"},Oe={class:"hidden sm:block text-sm text-gray-700 mb-3 sm:mb-0"},$e={class:"font-medium"},Ne={class:"font-medium"},ze={class:"font-medium"},Fe={class:"flex-1 flex justify-between sm:justify-end space-x-3"},Me=["disabled"],Be=["disabled"],Ge={__name:"Index",props:{incidents:Object,filters:Object,statusOptions:Array,typeOptions:Array,stats:Object},setup(l){const d=l,r=_({search:d.filters.search||null,status:d.filters.status||null,type:d.filters.type||null,date_from:d.filters.date_from||null,date_to:d.filters.date_to||null}),b=_(!1),C=_(null),j="AIzaSyCze3Rf8MLdkVJeRk207bfNJ6tqs41WLhU",R=W(()=>{if(d.incidents.data.length===0)return{lat:0,lng:0};const o=d.incidents.data[0];return{lat:parseFloat(o.lat),lng:parseFloat(o.lng)}}),U=o=>({accident:"car-crash",crime:"handcuffs",natural_disaster:"tornado",health_emergency:"heart-pulse",other:"triangle-exclamation"})[o]||"triangle-exclamation",O=o=>({url:`https://maps.google.com/mapfiles/ms/icons/${{reported:"red",investigating:"orange",resolved:"green",closed:"gray"}[o]||"red"}-dot.png`,scaledSize:{width:32,height:32}}),$=o=>({"bg-red-100 text-red-800":o==="reported","bg-yellow-100 text-yellow-800":o==="investigating","bg-blue-100 text-blue-800":o==="resolved","bg-gray-100 text-gray-800":o==="closed"}),N=o=>new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});let T=null;const z=()=>{clearTimeout(T),T=setTimeout(h,500)},h=()=>{v.get(route("incidents.index"),r.value,{preserveState:!0,replace:!0})},F=()=>{d.incidents.next_page_url&&v.get(d.incidents.next_page_url,{},{preserveState:!0})},M=()=>{d.incidents.prev_page_url&&v.get(d.incidents.prev_page_url,{},{preserveState:!0})},B=o=>{v.post(route("incidents.update-status",o.id),{status:o.status},{preserveScroll:!0})},L=o=>{C.value=o,b.value=!0},P=()=>{v.delete(route("incidents.destroy",C.value.id),{preserveScroll:!0,onSuccess:()=>{b.value=!1}})};return E(()=>r.value,()=>{h()},{deep:!0}),(o,t)=>(n(),D(H,null,{default:u(()=>{var V;return[i(m(J),{title:"Incident Reports"}),e("div",X,[e("div",Y,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-800"},"Incident Management"),e("p",{class:"mt-1 text-sm text-gray-600"},"Track and manage all reported incidents")],-1)),i(m(k),{href:o.route("incidents.create"),class:"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150"},{default:u(()=>t[6]||(t[6]=[e("i",{class:"fas fa-plus mr-2"},null,-1),g(" Report Incident ")])),_:1},8,["href"])]),e("div",ee,[e("div",te,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.value.search=s),type:"text",placeholder:"Search incidents...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",onInput:z},null,544),[[S,r.value.search]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),f(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",onChange:h},[t[9]||(t[9]=e("option",{value:null},"All Statuses",-1)),(n(!0),c(x,null,y(l.statusOptions,s=>(n(),c("option",{value:s,key:s},a(s),9,se))),128))],544),[[I,r.value.status]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Type",-1)),f(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.type=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",onChange:h},[t[11]||(t[11]=e("option",{value:null},"All Types",-1)),(n(!0),c(x,null,y(l.typeOptions,s=>(n(),c("option",{value:s,key:s},a(s),9,oe))),128))],544),[[I,r.value.type]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date Range",-1)),e("div",le,[f(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.value.date_from=s),type:"date",class:"w-1/2 rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm"},null,512),[[S,r.value.date_from]]),f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value.date_to=s),type:"date",class:"w-1/2 rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm"},null,512),[[S,r.value.date_to]])])])])]),e("div",ae,[i(w,{title:"Total Incidents",value:(V=l.stats)==null?void 0:V.total,icon:"triangle-exclamation",color:"gray"},null,8,["value"]),i(w,{title:"Reported",value:l.stats.reported,icon:"flag",color:"yellow"},null,8,["value"]),i(w,{title:"Investigating",value:l.stats.investigating,icon:"magnifying-glass",color:"blue"},null,8,["value"]),i(w,{title:"Resolved",value:l.stats.resolved,icon:"check-circle",color:"green"},null,8,["value"])]),e("div",re,[e("div",ne,[t[14]||(t[14]=e("div",{class:"p-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Incident Locations")],-1)),e("div",de,[i(m(q),{"api-key":m(j),style:{width:"100%",height:"100%"},center:R.value,zoom:12},{default:u(()=>[(n(!0),c(x,null,y(l.incidents.data,s=>(n(),D(m(K),{key:s.id,options:{position:{lat:parseFloat(s.lat),lng:parseFloat(s.lng)},icon:O(s.status)}},{default:u(()=>[i(m(G),null,{default:u(()=>[e("div",ie,[e("div",ue,a(s.name),1),e("div",ce,a(s.type),1),e("div",me,a(s.area),1)])]),_:2},1024)]),_:2},1032,["options"]))),128))]),_:1},8,["api-key","center"])])]),e("div",ge,[e("div",pe,[e("table",fe,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Incident "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type/Area "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reported "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",xe,[l.incidents.data.length===0?(n(),c("tr",ye,t[15]||(t[15]=[e("td",{colspan:"5",class:"px-6 py-4 text-center text-gray-500"}," No incidents found ",-1)]))):Z("",!0),(n(!0),c(x,null,y(l.incidents.data,s=>(n(),c("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ve,[e("div",be,[e("div",he,[e("i",{class:A(`fas fa-${U(s.type)} text-red-600`)},null,2)]),e("div",we,[e("div",_e,a(s.name),1),e("div",ke,a(s.details),1)])])]),e("td",Se,[e("div",Ie,a(s.type),1),e("div",Ce,a(s.area),1)]),e("td",Te,[f(e("select",{"onUpdate:modelValue":p=>s.status=p,onChange:p=>B(s),class:A(["block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",$(s.status)])},[(n(!0),c(x,null,y(l.statusOptions,p=>(n(),c("option",{value:p,key:p},a(p),9,De))),128))],42,Ve),[[I,s.status]])]),e("td",Ae,a(N(s.created_at)),1),e("td",je,[i(m(k),{href:o.route("incidents.show",s.id),class:"text-red-600 hover:text-red-900 mr-3",title:"View"},{default:u(()=>t[16]||(t[16]=[e("i",{class:"fas fa-eye"},null,-1)])),_:2},1032,["href"]),i(m(k),{href:o.route("incidents.edit",s.id),class:"text-blue-600 hover:text-blue-900 mr-3",title:"Edit"},{default:u(()=>t[17]||(t[17]=[e("i",{class:"fas fa-edit"},null,-1)])),_:2},1032,["href"]),e("button",{onClick:p=>L(s),class:"text-gray-600 hover:text-gray-900",title:"Delete"},t[18]||(t[18]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Re)])]))),128))])])]),e("div",Ue,[e("div",Oe,[t[20]||(t[20]=g(" Showing ")),e("span",$e,a(l.incidents.from),1),t[21]||(t[21]=g(" to ")),e("span",Ne,a(l.incidents.to),1),t[22]||(t[22]=g(" of ")),e("span",ze,a(l.incidents.total),1),t[23]||(t[23]=g(" incidents "))]),e("div",Fe,[e("button",{onClick:M,disabled:!l.incidents.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,Me),e("button",{onClick:F,disabled:!l.incidents.next_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Be)])])])])]),i(Q,{show:b.value,onClose:t[5]||(t[5]=s=>b.value=!1),onConfirm:P},{title:u(()=>t[24]||(t[24]=[g(" Delete Incident Report ")])),content:u(()=>t[25]||(t[25]=[g(" Are you sure you want to delete this incident report? This action cannot be undone. ")])),confirmButton:u(()=>t[26]||(t[26]=[g(" Delete Incident ")])),_:1},8,["show"])]}),_:1}))}};export{Ge as default};
