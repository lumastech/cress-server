import{r as _,i as W,p as E,c as A,o as d,w as i,b as r,a as e,u as g,j as J,S as k,f as m,l as p,v as S,d as c,F as v,g as y,t as a,m as C,e as Z,n as $,W as b}from"./app-fmBYqYJA.js";import{A as q,T as K,Z as G}from"./index-B1r_7o6V.js";import{_ as H}from"./DashLayout-Cg7r8qi_.js";import{_ as Q}from"./ConfirmationModal-BpEc04mx.js";import{_ as w}from"./StatCard-DX42AZRs.js";import{_ as X}from"./DangerButton-BAAcJ2PR.js";import{_ as Y}from"./SecondaryButton-Brfk25UT.js";import"./index-CGqcT73v.js";import"./logo-CL_3b9da.js";import"./Modal-DQj1sryE.js";const ee={class:"space-y-6"},te={class:"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4"},se={class:"bg-white rounded-lg shadow p-4"},oe={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},le=["value"],ae=["value"],re={class:"flex space-x-2"},ne={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},de={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ie={class:"lg:col-span-1 bg-white rounded-lg shadow overflow-hidden"},ue={class:"h-96"},ce={class:"text-sm"},me={class:"font-medium"},ge={class:"text-gray-600"},fe={class:"text-xs mt-1"},pe={class:"lg:col-span-2 bg-white rounded-lg shadow overflow-hidden"},xe={class:"overflow-x-auto"},ve={class:"min-w-full divide-y divide-gray-200"},ye={class:"bg-white divide-y divide-gray-200"},be={key:0},he={class:"px-6 py-4 whitespace-nowrap"},we={class:"flex items-center"},_e={class:"flex-shrink-0 h-10 w-10 rounded-full bg-red-100 flex items-center justify-center"},ke={class:"ml-4"},Se={class:"text-sm font-medium text-gray-900"},Ce={class:"text-sm text-gray-500 truncate max-w-xs"},Ie={class:"px-6 py-4 whitespace-nowrap"},Te={class:"text-sm text-gray-900 capitalize"},Ve={class:"text-sm text-gray-500"},De={class:"px-6 py-4 whitespace-nowrap"},Ae=["onUpdate:modelValue","onChange"],$e=["value"],je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Re={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ue=["onClick"],Oe={class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6 flex flex-col sm:flex-row items-center justify-between"},Ne={class:"hidden sm:block text-sm text-gray-700 mb-3 sm:mb-0"},ze={class:"font-medium"},Fe={class:"font-medium"},Me={class:"font-medium"},Le={class:"flex-1 flex justify-between sm:justify-end space-x-3"},Be=["disabled"],Pe=["disabled"],Ye={__name:"Index",props:{incidents:Object,filters:Object,statusOptions:Array,typeOptions:Array,stats:Object},setup(l){const u=l,n=_({search:u.filters.search||null,status:u.filters.status||null,type:u.filters.type||null,date_from:u.filters.date_from||null,date_to:u.filters.date_to||null}),x=_(!1),I=_(null),j="AIzaSyCze3Rf8MLdkVJeRk207bfNJ6tqs41WLhU",R=W(()=>{if(u.incidents.data.length===0)return{lat:0,lng:0};const o=u.incidents.data[0];return{lat:parseFloat(o.lat),lng:parseFloat(o.lng)}}),U=o=>({accident:"car-crash",crime:"handcuffs",natural_disaster:"tornado",health_emergency:"heart-pulse",other:"triangle-exclamation"})[o]||"triangle-exclamation",O=o=>({url:`https://maps.google.com/mapfiles/ms/icons/${{reported:"red",investigating:"orange",resolved:"green",closed:"gray"}[o]||"red"}-dot.png`,scaledSize:{width:32,height:32}}),N=o=>({"bg-red-100 text-red-800":o==="reported","bg-yellow-100 text-yellow-800":o==="investigating","bg-blue-100 text-blue-800":o==="resolved","bg-gray-100 text-gray-800":o==="closed"}),z=o=>new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});let T=null;const F=()=>{clearTimeout(T),T=setTimeout(h,500)},h=()=>{b.get(route("incidents.index"),n.value,{preserveState:!0,replace:!0})},M=()=>{u.incidents.next_page_url&&b.get(u.incidents.next_page_url,{},{preserveState:!0})},L=()=>{u.incidents.prev_page_url&&b.get(u.incidents.prev_page_url,{},{preserveState:!0})},B=o=>{b.post(route("incidents.update-status",o.id),{status:o.status},{preserveScroll:!0})},P=o=>{I.value=o,x.value=!0},V=()=>{b.delete(route("incidents.destroy",I.value.id),{preserveScroll:!0,onSuccess:()=>{x.value=!1}})};return E(()=>n.value,()=>{h()},{deep:!0}),(o,t)=>(d(),A(H,null,{default:i(()=>{var D;return[r(g(J),{title:"Incident Reports"}),e("div",ee,[e("div",te,[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-800"},"Incident Management"),e("p",{class:"mt-1 text-sm text-gray-600"},"Track and manage all reported incidents")],-1)),r(g(k),{href:o.route("incidents.create"),class:"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150"},{default:i(()=>t[7]||(t[7]=[e("i",{class:"fas fa-plus mr-2"},null,-1),m(" Report Incident ")])),_:1},8,["href"])]),e("div",se,[e("div",oe,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.value.search=s),type:"text",placeholder:"Search incidents...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",onInput:F},null,544),[[S,n.value.search]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.value.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",onChange:h},[t[10]||(t[10]=e("option",{value:null},"All Statuses",-1)),(d(!0),c(v,null,y(l.statusOptions,s=>(d(),c("option",{value:s,key:s},a(s),9,le))),128))],544),[[C,n.value.status]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Type",-1)),p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.type=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",onChange:h},[t[12]||(t[12]=e("option",{value:null},"All Types",-1)),(d(!0),c(v,null,y(l.typeOptions,s=>(d(),c("option",{value:s,key:s},a(s),9,ae))),128))],544),[[C,n.value.type]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date Range",-1)),e("div",re,[p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.date_from=s),type:"date",class:"w-1/2 rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm"},null,512),[[S,n.value.date_from]]),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.value.date_to=s),type:"date",class:"w-1/2 rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm"},null,512),[[S,n.value.date_to]])])])])]),e("div",ne,[r(w,{title:"Total Incidents",value:(D=l.stats)==null?void 0:D.total,icon:"triangle-exclamation",color:"gray"},null,8,["value"]),r(w,{title:"Reported",value:l.stats.reported,icon:"flag",color:"yellow"},null,8,["value"]),r(w,{title:"Investigating",value:l.stats.investigating,icon:"magnifying-glass",color:"blue"},null,8,["value"]),r(w,{title:"Resolved",value:l.stats.resolved,icon:"check-circle",color:"green"},null,8,["value"])]),e("div",de,[e("div",ie,[t[15]||(t[15]=e("div",{class:"p-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Incident Locations")],-1)),e("div",ue,[r(g(q),{"api-key":g(j),style:{width:"100%",height:"100%"},center:R.value,zoom:12},{default:i(()=>[(d(!0),c(v,null,y(l.incidents.data,s=>(d(),A(g(K),{key:s.id,options:{position:{lat:parseFloat(s.lat),lng:parseFloat(s.lng)},icon:O(s.status)}},{default:i(()=>[r(g(G),null,{default:i(()=>[e("div",ce,[e("div",me,a(s.name),1),e("div",ge,a(s.type),1),e("div",fe,a(s.area),1)])]),_:2},1024)]),_:2},1032,["options"]))),128))]),_:1},8,["api-key","center"])])]),e("div",pe,[e("div",xe,[e("table",ve,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Incident "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type/Area "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reported "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",ye,[l.incidents.data.length===0?(d(),c("tr",be,t[16]||(t[16]=[e("td",{colspan:"5",class:"px-6 py-4 text-center text-gray-500"}," No incidents found ",-1)]))):Z("",!0),(d(!0),c(v,null,y(l.incidents.data,s=>(d(),c("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",he,[e("div",we,[e("div",_e,[e("i",{class:$(`fas fa-${U(s.type)} text-red-600`)},null,2)]),e("div",ke,[e("div",Se,a(s.name),1),e("div",Ce,a(s.details),1)])])]),e("td",Ie,[e("div",Te,a(s.type),1),e("div",Ve,a(s.area),1)]),e("td",De,[p(e("select",{"onUpdate:modelValue":f=>s.status=f,onChange:f=>B(s),class:$(["block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",N(s.status)])},[(d(!0),c(v,null,y(l.statusOptions,f=>(d(),c("option",{value:f,key:f},a(f),9,$e))),128))],42,Ae),[[C,s.status]])]),e("td",je,a(z(s.created_at)),1),e("td",Re,[r(g(k),{href:o.route("incidents.show",s.id),class:"text-red-600 hover:text-red-900 mr-3",title:"View"},{default:i(()=>t[17]||(t[17]=[e("i",{class:"fas fa-eye"},null,-1)])),_:2},1032,["href"]),r(g(k),{href:o.route("incidents.edit",s.id),class:"text-blue-600 hover:text-blue-900 mr-3",title:"Edit"},{default:i(()=>t[18]||(t[18]=[e("i",{class:"fas fa-edit"},null,-1)])),_:2},1032,["href"]),e("button",{onClick:f=>P(s),class:"text-gray-600 hover:text-gray-900",title:"Delete"},t[19]||(t[19]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ue)])]))),128))])])]),e("div",Oe,[e("div",Ne,[t[21]||(t[21]=m(" Showing ")),e("span",ze,a(l.incidents.from),1),t[22]||(t[22]=m(" to ")),e("span",Fe,a(l.incidents.to),1),t[23]||(t[23]=m(" of ")),e("span",Me,a(l.incidents.total),1),t[24]||(t[24]=m(" incidents "))]),e("div",Le,[e("button",{onClick:L,disabled:!l.incidents.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,Be),e("button",{onClick:M,disabled:!l.incidents.next_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Pe)])])])])]),r(Q,{show:x.value,onClose:t[6]||(t[6]=s=>x.value=!1),onConfirm:V},{title:i(()=>t[25]||(t[25]=[m(" Delete Incident Report ")])),content:i(()=>t[26]||(t[26]=[m(" Are you sure you want to delete this incident report? This action cannot be undone. ")])),footer:i(()=>[r(Y,{onClick:t[5]||(t[5]=s=>x.value=!1)},{default:i(()=>t[27]||(t[27]=[m("Cancel")])),_:1}),r(X,{class:"ms-3",onClick:V},{default:i(()=>t[28]||(t[28]=[m("Delete Incident")])),_:1})]),_:1},8,["show"])]}),_:1}))}};export{Ye as default};
