import{r as z,c as B,o as d,w as r,b as a,a as t,u as l,j as F,t as o,n as h,S as v,f as c,d as u,e as L,F as b,g as p,W as m}from"./app-Dgtfbg1u.js";import{A as R,T as V,Z as _}from"./index-3TkUqxE7.js";import{_ as N}from"./DashLayout-BOSY-Fsh.js";import{_ as T}from"./ConfirmationModal-BVPsSkgJ.js";import"./logo-CL_3b9da.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-Bz_5xRiF.js";const W={class:"max-w-4xl mx-auto"},E={class:"mb-8"},O={class:"flex items-center justify-between"},q={class:"text-2xl font-bold text-gray-800"},J={class:"flex items-center mt-2 space-x-4"},U={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize"},Z={class:"text-sm text-gray-500"},G={class:"flex space-x-2"},K={class:"bg-white shadow rounded-lg overflow-hidden"},H={class:"p-6 space-y-6"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Q={class:"space-y-4"},X={class:"flex items-start"},Y={class:"text-sm text-gray-600"},tt={class:"flex items-start"},et={class:"text-sm text-gray-600"},st=["href"],nt={class:"h-64 md:h-full rounded-md overflow-hidden border border-gray-200"},it={class:"text-sm"},ot={class:"font-medium"},rt={class:"text-gray-600 capitalize"},dt={class:"prose prose-sm max-w-none text-gray-600 whitespace-pre-line"},at={class:"border-t border-gray-200 pt-4"},lt={class:"flex flex-wrap gap-3"},ct=["onClick"],ut={key:0},mt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ft=["href"],gt=["src","alt"],xt={key:1,class:"text-center p-4"},yt={class:"text-xs text-gray-500 truncate"},ht=["onClick"],vt={class:"border-t border-gray-200 pt-4"},bt={class:"flex items-center space-x-4"},pt={class:"text-sm font-medium text-gray-900"},wt={class:"text-sm text-gray-500"},kt={class:"px-6 py-3 bg-gray-50 border-t border-gray-200 flex justify-between items-center"},St={class:"text-sm text-gray-500"},zt={__name:"Show",props:{incident:Object,statusOptions:Array},setup(s){const f=s,g=z(!1),w="AIzaSyCze3Rf8MLdkVJeRk207bfNJ6tqs41WLhU",k=i=>({"bg-red-100 text-red-800":i==="reported","bg-yellow-100 text-yellow-800":i==="investigating","bg-blue-100 text-blue-800":i==="resolved","bg-gray-100 text-gray-800":i==="closed"}),S=i=>`https://maps.google.com/mapfiles/ms/icons/${{reported:"red",investigating:"orange",resolved:"green",closed:"gray"}[i]||"red"}-dot.png`,C=i=>i.startsWith("image/"),D=i=>new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),y=i=>{const e=new Date(i),n=Math.floor((new Date-e)/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)} minutes ago`:n<86400?`${Math.floor(n/3600)} hours ago`:`${Math.floor(n/86400)} days ago`},$=i=>{m.patch(route("incidents.update-status",f.incident.id),{status:i},{preserveScroll:!0})},I=i=>{confirm("Are you sure you want to delete this evidence?")&&m.delete(route("incidents.media.destroy",[f.incident.id,i]),{preserveScroll:!0})},A=()=>{g.value=!0},M=()=>{m.delete(route("incidents.destroy",f.incident.id),{onSuccess:()=>{m.visit(route("incidents.index"))}})};return(i,e)=>(d(),B(N,null,{default:r(()=>{var x;return[a(l(F),{title:s.incident.name},null,8,["title"]),t("div",W,[t("div",E,[t("div",O,[t("div",null,[t("h1",q,o(s.incident.name),1),t("div",J,[t("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",k(s.incident.status)])},o(s.incident.status),3),t("span",U,o(s.incident.type),1),t("span",Z," Reported "+o(D(s.incident.created_at)),1)])]),t("div",G,[a(l(v),{href:i.route("incidents.index"),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},{default:r(()=>e[1]||(e[1]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),c(" Back ")])),_:1},8,["href"]),a(l(v),{href:i.route("incidents.edit",s.incident.id),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},{default:r(()=>e[2]||(e[2]=[t("i",{class:"fas fa-edit mr-2"},null,-1),c(" Edit ")])),_:1},8,["href"])])])]),t("div",K,[t("div",H,[t("div",P,[t("div",null,[e[8]||(e[8]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Location Details",-1)),t("div",Q,[t("div",X,[e[4]||(e[4]=t("i",{class:"fas fa-map-marker-alt text-gray-400 mt-0.5 mr-3"},null,-1)),t("div",null,[e[3]||(e[3]=t("p",{class:"text-sm font-medium text-gray-900"},"Area",-1)),t("p",Y,o(s.incident.area),1)])]),t("div",tt,[e[6]||(e[6]=t("i",{class:"fas fa-map-pin text-gray-400 mt-0.5 mr-3"},null,-1)),t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm font-medium text-gray-900"},"Coordinates",-1)),t("p",et,o(s.incident.lat)+", "+o(s.incident.lng),1)])]),t("a",{href:`https://maps.google.com/?q=${s.incident.lat},${s.incident.lng}`,target:"_blank",class:"inline-flex items-center text-sm text-red-600 hover:text-red-800"},e[7]||(e[7]=[t("i",{class:"fas fa-external-link-alt mr-2"},null,-1),c(" View on Google Maps ")]),8,st)])]),t("div",nt,[a(l(R),{"api-key":l(w),style:{width:"100%",height:"100%"},center:{lat:parseFloat(s.incident.lat),lng:parseFloat(s.incident.lng)},zoom:15},{default:r(()=>[a(l(V),{options:{position:{lat:parseFloat(s.incident.lat),lng:parseFloat(s.incident.lng)},icon:{url:S(s.incident.status),scaledSize:{width:32,height:32}}}},{default:r(()=>[a(l(_),null,{default:r(()=>[t("div",it,[t("div",ot,o(s.incident.name),1),t("div",rt,o(s.incident.type),1)])]),_:1})]),_:1},8,["options"])]),_:1},8,["api-key","center"])])]),t("div",null,[e[9]||(e[9]=t("h2",{class:"text-lg font-medium text-gray-900 mb-2"},"Incident Details",-1)),t("div",dt,o(s.incident.details),1)]),t("div",at,[e[10]||(e[10]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Status Management",-1)),t("div",lt,[(d(!0),u(b,null,p(s.statusOptions,n=>(d(),u("button",{key:n,onClick:j=>$(n),class:h(["px-4 py-2 rounded-md text-sm font-medium transition-colors",n===s.incident.status?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800 hover:bg-gray-200"])},o(n),11,ct))),128))])]),s.incident.media&&s.incident.media.length>0?(d(),u("div",ut,[e[13]||(e[13]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Evidence",-1)),t("div",mt,[(d(!0),u(b,null,p(s.incident.media,n=>(d(),u("div",{key:n.id,class:"relative group rounded-md overflow-hidden border border-gray-200"},[t("a",{href:n.original_url,target:"_blank",class:"block h-40 bg-gray-100 flex items-center justify-center"},[C(n.mime_type)?(d(),u("img",{key:0,src:n.original_url,alt:`Incident evidence ${n.id}`,class:"h-full w-full object-cover"},null,8,gt)):(d(),u("div",xt,[e[11]||(e[11]=t("i",{class:"fas fa-file text-4xl text-gray-400 mb-2"},null,-1)),t("p",yt,o(n.file_name),1)]))],8,ft),t("button",{onClick:j=>I(n.id),class:"absolute top-2 right-2 bg-red-600 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},e[12]||(e[12]=[t("i",{class:"fas fa-trash text-xs"},null,-1)]),8,ht)]))),128))])])):L("",!0),t("div",vt,[e[15]||(e[15]=t("h2",{class:"text-lg font-medium text-gray-900 mb-2"},"Reporter Information",-1)),t("div",bt,[e[14]||(e[14]=t("div",{class:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center"},[t("i",{class:"fas fa-user text-gray-500"})],-1)),t("div",null,[t("p",pt,o(((x=s.incident.user)==null?void 0:x.name)||"Anonymous"),1),t("p",wt," Reported "+o(y(s.incident.created_at)),1)])])])]),t("div",kt,[t("div",St," Last updated "+o(y(s.incident.updated_at)),1),t("div",{class:"flex space-x-3"},[t("button",{onClick:A,class:"text-sm font-medium text-red-600 hover:text-red-900"},e[16]||(e[16]=[t("i",{class:"fas fa-trash mr-1"},null,-1),c(" Delete Incident ")]))])])])]),a(T,{show:g.value,onClose:e[0]||(e[0]=n=>g.value=!1),onConfirm:M},{title:r(()=>e[17]||(e[17]=[c(" Delete Incident Report ")])),content:r(()=>e[18]||(e[18]=[c(" Are you sure you want to delete this incident report? This action cannot be undone. ")])),confirmButton:r(()=>e[19]||(e[19]=[c(" Delete Incident ")])),_:1},8,["show"])]}),_:1}))}};export{zt as default};
