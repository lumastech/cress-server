import{r as j,c as z,o as a,w as r,b as l,a as t,u as c,j as F,t as o,n as h,S as b,f as d,d as u,e as L,F as p,g as w,W as f}from"./app-DUy5hM89.js";import{A as R,T as V,Z as B}from"./index-Bjp_0yKm.js";import{_ as N}from"./DashLayout-C8ZDk2gm.js";import{_ as T}from"./ConfirmationModal-Dgu0hkMC.js";import{_ as W}from"./DangerButton-BZFYamX_.js";import{_ as E}from"./SecondaryButton-BRUg9goR.js";import"./logo-CL_3b9da.js";import"./Modal-DSS9I96Z.js";const O={class:"max-w-4xl mx-auto"},q={class:"mb-8"},J={class:"flex items-center justify-between"},U={class:"text-2xl font-bold text-gray-800"},Z={class:"flex items-center mt-2 space-x-4"},G={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize"},K={class:"text-sm text-gray-500"},H={class:"flex space-x-2"},P={class:"bg-white shadow rounded-lg overflow-hidden"},Q={class:"p-6 space-y-6"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Y={class:"space-y-4"},tt={class:"flex items-start"},et={class:"text-sm text-gray-600"},st={class:"flex items-start"},nt={class:"text-sm text-gray-600"},it=["href"],ot={class:"h-64 md:h-full rounded-md overflow-hidden border border-gray-200"},rt={class:"text-sm"},lt={class:"font-medium"},at={class:"text-gray-600 capitalize"},dt={class:"prose prose-sm max-w-none text-gray-600 whitespace-pre-line"},ct={class:"border-t border-gray-200 pt-4"},ut={class:"flex flex-wrap gap-3"},mt=["onClick"],ft={key:0},gt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},xt=["href"],yt=["src","alt"],vt={key:1,class:"text-center p-4"},ht={class:"text-xs text-gray-500 truncate"},bt=["onClick"],pt={class:"border-t border-gray-200 pt-4"},wt={class:"flex items-center space-x-4"},kt={class:"text-sm font-medium text-gray-900"},Ct={class:"text-sm text-gray-500"},$t={class:"px-6 py-3 bg-gray-50 border-t border-gray-200 flex justify-between items-center"},St={class:"text-sm text-gray-500"},Lt={__name:"Show",props:{incident:Object,statusOptions:Array},setup(s){const g=s,m=j(!1),k="AIzaSyCze3Rf8MLdkVJeRk207bfNJ6tqs41WLhU",C=i=>({"bg-red-100 text-red-800":i==="reported","bg-yellow-100 text-yellow-800":i==="investigating","bg-blue-100 text-blue-800":i==="resolved","bg-gray-100 text-gray-800":i==="closed"}),$=i=>`https://maps.google.com/mapfiles/ms/icons/${{reported:"red",investigating:"orange",resolved:"green",closed:"gray"}[i]||"red"}-dot.png`,S=i=>i.startsWith("image/"),D=i=>new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),y=i=>{const e=new Date(i),n=Math.floor((new Date-e)/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)} minutes ago`:n<86400?`${Math.floor(n/3600)} hours ago`:`${Math.floor(n/86400)} days ago`},I=i=>{f.patch(route("incidents.update-status",g.incident.id),{status:i},{preserveScroll:!0})},A=i=>{confirm("Are you sure you want to delete this evidence?")&&f.delete(route("incidents.media.destroy",[g.incident.id,i]),{preserveScroll:!0})},M=()=>{m.value=!0},v=()=>{f.delete(route("incidents.destroy",g.incident.id),{onSuccess:()=>{f.visit(route("incidents.index"))}})};return(i,e)=>(a(),z(N,null,{default:r(()=>{var x;return[l(c(F),{title:s.incident.name},null,8,["title"]),t("div",O,[t("div",q,[t("div",J,[t("div",null,[t("h1",U,o(s.incident.name),1),t("div",Z,[t("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",C(s.incident.status)])},o(s.incident.status),3),t("span",G,o(s.incident.type),1),t("span",K," Reported "+o(D(s.incident.created_at)),1)])]),t("div",H,[l(c(b),{href:i.route("incidents.index"),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},{default:r(()=>e[2]||(e[2]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),d(" Back ")])),_:1},8,["href"]),l(c(b),{href:i.route("incidents.edit",s.incident.id),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},{default:r(()=>e[3]||(e[3]=[t("i",{class:"fas fa-edit mr-2"},null,-1),d(" Edit ")])),_:1},8,["href"])])])]),t("div",P,[t("div",Q,[t("div",X,[t("div",null,[e[9]||(e[9]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Location Details",-1)),t("div",Y,[t("div",tt,[e[5]||(e[5]=t("i",{class:"fas fa-map-marker-alt text-gray-400 mt-0.5 mr-3"},null,-1)),t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm font-medium text-gray-900"},"Area",-1)),t("p",et,o(s.incident.area),1)])]),t("div",st,[e[7]||(e[7]=t("i",{class:"fas fa-map-pin text-gray-400 mt-0.5 mr-3"},null,-1)),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-gray-900"},"Coordinates",-1)),t("p",nt,o(s.incident.lat)+", "+o(s.incident.lng),1)])]),t("a",{href:`https://maps.google.com/?q=${s.incident.lat},${s.incident.lng}`,target:"_blank",class:"inline-flex items-center text-sm text-red-600 hover:text-red-800"},e[8]||(e[8]=[t("i",{class:"fas fa-external-link-alt mr-2"},null,-1),d(" View on Google Maps ")]),8,it)])]),t("div",ot,[l(c(R),{"api-key":c(k),style:{width:"100%",height:"100%"},center:{lat:parseFloat(s.incident.lat),lng:parseFloat(s.incident.lng)},zoom:15},{default:r(()=>[l(c(V),{options:{position:{lat:parseFloat(s.incident.lat),lng:parseFloat(s.incident.lng)},icon:{url:$(s.incident.status),scaledSize:{width:32,height:32}}}},{default:r(()=>[l(c(B),null,{default:r(()=>[t("div",rt,[t("div",lt,o(s.incident.name),1),t("div",at,o(s.incident.type),1)])]),_:1})]),_:1},8,["options"])]),_:1},8,["api-key","center"])])]),t("div",null,[e[10]||(e[10]=t("h2",{class:"text-lg font-medium text-gray-900 mb-2"},"Incident Details",-1)),t("div",dt,o(s.incident.details),1)]),t("div",ct,[e[11]||(e[11]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Status Management",-1)),t("div",ut,[(a(!0),u(p,null,w(s.statusOptions,n=>(a(),u("button",{key:n,onClick:_=>I(n),class:h(["px-4 py-2 rounded-md text-sm font-medium transition-colors",n===s.incident.status?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800 hover:bg-gray-200"])},o(n),11,mt))),128))])]),s.incident.media&&s.incident.media.length>0?(a(),u("div",ft,[e[14]||(e[14]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Evidence",-1)),t("div",gt,[(a(!0),u(p,null,w(s.incident.media,n=>(a(),u("div",{key:n.id,class:"relative group rounded-md overflow-hidden border border-gray-200"},[t("a",{href:n.original_url,target:"_blank",class:"block h-40 bg-gray-100 flex items-center justify-center"},[S(n.mime_type)?(a(),u("img",{key:0,src:n.original_url,alt:`Incident evidence ${n.id}`,class:"h-full w-full object-cover"},null,8,yt)):(a(),u("div",vt,[e[12]||(e[12]=t("i",{class:"fas fa-file text-4xl text-gray-400 mb-2"},null,-1)),t("p",ht,o(n.file_name),1)]))],8,xt),t("button",{onClick:_=>A(n.id),class:"absolute top-2 right-2 bg-red-600 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},e[13]||(e[13]=[t("i",{class:"fas fa-trash text-xs"},null,-1)]),8,bt)]))),128))])])):L("",!0),t("div",pt,[e[16]||(e[16]=t("h2",{class:"text-lg font-medium text-gray-900 mb-2"},"Reporter Information",-1)),t("div",wt,[e[15]||(e[15]=t("div",{class:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center"},[t("i",{class:"fas fa-user text-gray-500"})],-1)),t("div",null,[t("p",kt,o(((x=s.incident.user)==null?void 0:x.name)||"Anonymous"),1),t("p",Ct," Reported "+o(y(s.incident.created_at)),1)])])])]),t("div",$t,[t("div",St," Last updated "+o(y(s.incident.updated_at)),1),t("div",{class:"flex space-x-3"},[t("button",{onClick:M,class:"text-sm font-medium text-red-600 hover:text-red-900"},e[17]||(e[17]=[t("i",{class:"fas fa-trash mr-1"},null,-1),d(" Delete Incident ")]))])])])]),l(T,{show:m.value,onClose:e[1]||(e[1]=n=>m.value=!1),onConfirm:v},{title:r(()=>e[18]||(e[18]=[d(" Delete Incident Report ")])),content:r(()=>e[19]||(e[19]=[d(" Are you sure you want to delete this incident report? This action cannot be undone. ")])),footer:r(()=>[l(E,{onClick:e[0]||(e[0]=n=>m.value=!1)},{default:r(()=>e[20]||(e[20]=[d("Cancel")])),_:1}),l(W,{class:"ms-3",onClick:v},{default:r(()=>e[21]||(e[21]=[d("Delete Incident")])),_:1})]),_:1},8,["show"])]}),_:1}))}};export{Lt as default};
