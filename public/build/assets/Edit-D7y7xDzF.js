import{z as D,p as I,c as h,o as d,w as b,b as y,a as e,u as g,j as O,t as a,S as B,f as p,m as k,d as i,e as m,k as u,n as c,l as f,F as x,g as v,v as w,W as S}from"./app-DbxfOtpw.js";import{A as N,T}from"./index-C9ZgLHPu.js";import{_ as z}from"./DashLayout-BoOREkzb.js";import"./logo-CL_3b9da.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"max-w-3xl mx-auto"},R={class:"mb-8"},$={class:"flex items-center justify-between"},J={class:"mt-1 text-sm text-gray-600"},W={class:"bg-white shadow rounded-lg overflow-hidden"},G={class:"p-6 space-y-6"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},K={class:"md:col-span-2"},H={key:0,class:"mt-1 text-sm text-red-600"},Q=["value"],X={key:0,class:"mt-1 text-sm text-red-600"},Y=["value"],Z={key:0,class:"mt-1 text-sm text-red-600"},_={class:"md:col-span-2"},ee={key:0,class:"mt-1 text-sm text-red-600"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},se={class:"h-64 md:h-full"},re={class:"space-y-4"},oe={class:"grid grid-cols-2 gap-4"},de={key:0,class:"mt-1 text-sm text-red-600"},ne={key:0,class:"mt-1 text-sm text-red-600"},le={key:0,class:"mt-1 text-sm text-red-600"},ie={key:0},ae={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},me=["src"],ue=["onClick"],ce={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},ge={class:"space-y-1 text-center"},fe={class:"flex text-sm text-gray-600"},be={for:"file-upload",class:"relative cursor-pointer bg-white rounded-md font-medium text-red-600 hover:text-red-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-red-500"},ye={class:"px-6 py-3 bg-gray-50 text-right border-t border-gray-200"},pe=["disabled"],xe={key:0,class:"fas fa-circle-notch fa-spin mr-2"},ve={key:1,class:"fas fa-save mr-2"},Ue={__name:"Edit",props:{incident:Object,errors:Object,typeOptions:Array,statusOptions:Array},setup(r){const l=r,C="AIzaSyCze3Rf8MLdkVJeRk207bfNJ6tqs41WLhU",s=D({name:l.incident.name,type:l.incident.type,status:l.incident.status,area:l.incident.area,details:l.incident.details,lat:l.incident.lat,lng:l.incident.lng,media:[],processing:!1}),L=I(()=>({lat:parseFloat(s.lat)||0,lng:parseFloat(s.lng)||0})),U=n=>`https://maps.google.com/mapfiles/ms/icons/${{reported:"red",investigating:"orange",resolved:"green",closed:"gray"}[n]||"red"}-dot.png`,V=n=>{s.lat=n.latLng.lat(),s.lng=n.latLng.lng()},M=n=>{s.lat=n.latLng.lat(),s.lng=n.latLng.lng()},A=n=>{s.media=n.target.files},F=n=>{confirm("Are you sure you want to delete this media?")&&S.delete(route("incidents.media.destroy",[l.incident.id,n]),{preserveScroll:!0})},j=()=>{const n=new FormData;Object.keys(s).forEach(t=>{t!=="processing"&&t!=="media"&&n.append(t,s[t])}),s.media&&s.media.length>0&&Array.from(s.media).forEach(t=>{n.append("media[]",t)}),S.post(route("incidents.update",l.incident.id),{_method:"PUT",...Object.fromEntries(n)},{onStart:()=>s.processing=!0,onFinish:()=>s.processing=!1,preserveScroll:!0})},E=()=>{s.name=l.incident.name,s.type=l.incident.type,s.status=l.incident.status,s.area=l.incident.area,s.details=l.incident.details,s.lat=l.incident.lat,s.lng=l.incident.lng,s.media=[]};return(n,t)=>(d(),h(z,null,{default:b(()=>[y(g(O),{title:`Edit Incident - ${r.incident.name}`},null,8,["title"]),e("div",P,[e("div",R,[e("div",$,[e("div",null,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold text-gray-800"},"Edit Incident Report",-1)),e("p",J,"Update details for "+a(r.incident.name),1)]),y(g(B),{href:n.route("incidents.index"),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},{default:b(()=>t[8]||(t[8]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),p(" Back to List ")])),_:1},8,["href"])])]),e("div",W,[e("form",{onSubmit:k(j,["prevent"])},[e("div",G,[e("div",null,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4 pb-2 border-b border-gray-200"},"Basic Information",-1)),e("div",q,[e("div",K,[t[9]||(t[9]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Incident Title *",-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.name=o),type:"text",id:"name",class:c(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm",{"border-red-300":r.errors.name}])},null,2),[[f,s.name]]),r.errors.name?(d(),i("p",H,a(r.errors.name),1)):m("",!0)]),e("div",null,[t[11]||(t[11]=e("label",{for:"type",class:"block text-sm font-medium text-gray-700"},"Type *",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.type=o),id:"type",class:c(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm",{"border-red-300":r.errors.type}])},[t[10]||(t[10]=e("option",{value:"",disabled:""},"Select type",-1)),(d(!0),i(x,null,v(r.typeOptions,o=>(d(),i("option",{value:o,key:o},a(o.replace("_"," ")),9,Q))),128))],2),[[w,s.type]]),r.errors.type?(d(),i("p",X,a(r.errors.type),1)):m("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700"},"Status *",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.status=o),id:"status",class:c(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm",{"border-red-300":r.errors.status}])},[t[12]||(t[12]=e("option",{value:"",disabled:""},"Select status",-1)),(d(!0),i(x,null,v(r.statusOptions,o=>(d(),i("option",{value:o,key:o},a(o),9,Y))),128))],2),[[w,s.status]]),r.errors.status?(d(),i("p",Z,a(r.errors.status),1)):m("",!0)]),e("div",_,[t[14]||(t[14]=e("label",{for:"area",class:"block text-sm font-medium text-gray-700"},"Area/Location *",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.area=o),type:"text",id:"area",class:c(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm",{"border-red-300":r.errors.area}])},null,2),[[f,s.area]]),r.errors.area?(d(),i("p",ee,a(r.errors.area),1)):m("",!0)])])]),e("div",null,[t[20]||(t[20]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4 pb-2 border-b border-gray-200"},"Location on Map",-1)),e("div",te,[e("div",se,[y(g(N),{"api-key":g(C),style:{width:"100%",height:"100%"},center:L.value,zoom:15,onClick:V},{default:b(()=>[s.lat&&s.lng?(d(),h(g(T),{key:0,options:{position:{lat:parseFloat(s.lat),lng:parseFloat(s.lng)},draggable:!0,icon:{url:U(s.status),scaledSize:{width:32,height:32}}},onDragend:M},null,8,["options"])):m("",!0)]),_:1},8,["api-key","center"])]),e("div",null,[e("div",re,[t[18]||(t[18]=e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700"},"Pin Location"),e("p",{class:"mt-1 text-sm text-gray-500"}," Click on the map or drag the marker to adjust location ")],-1)),e("div",oe,[e("div",null,[t[16]||(t[16]=e("label",{for:"lat",class:"block text-sm font-medium text-gray-700"},"Latitude *",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.lat=o),type:"number",step:"any",id:"lat",class:c(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm",{"border-red-300":r.errors.lat}])},null,2),[[f,s.lat]]),r.errors.lat?(d(),i("p",de,a(r.errors.lat),1)):m("",!0)]),e("div",null,[t[17]||(t[17]=e("label",{for:"lng",class:"block text-sm font-medium text-gray-700"},"Longitude *",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>s.lng=o),type:"number",step:"any",id:"lng",class:c(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm",{"border-red-300":r.errors.lng}])},null,2),[[f,s.lng]]),r.errors.lng?(d(),i("p",ne,a(r.errors.lng),1)):m("",!0)])]),t[19]||(t[19]=e("div",{class:"bg-gray-50 p-3 rounded-md text-sm text-gray-600"},[e("i",{class:"fas fa-info-circle mr-1 text-red-600"}),p(" For precise location, you can search coordinates on "),e("a",{href:"https://www.latlong.net/",target:"_blank",class:"text-red-600 hover:underline"},"latlong.net")],-1))])])])]),e("div",null,[t[22]||(t[22]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4 pb-2 border-b border-gray-200"},"Incident Details",-1)),e("div",null,[t[21]||(t[21]=e("label",{for:"details",class:"block text-sm font-medium text-gray-700"},"Description *",-1)),u(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=o=>s.details=o),id:"details",rows:"4",class:c(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm",{"border-red-300":r.errors.details}])},null,2),[[f,s.details]]),r.errors.details?(d(),i("p",le,a(r.errors.details),1)):m("",!0)])]),r.incident.media&&r.incident.media.length>0?(d(),i("div",ie,[t[24]||(t[24]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4 pb-2 border-b border-gray-200"},"Current Evidence",-1)),e("div",ae,[(d(!0),i(x,null,v(r.incident.media,o=>(d(),i("div",{key:o.id,class:"relative group"},[e("img",{src:o.original_url,alt:"Incident evidence",class:"rounded-md h-24 w-full object-cover"},null,8,me),e("button",{onClick:k(he=>F(o.id),["prevent"]),class:"absolute top-1 right-1 bg-red-600 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},t[23]||(t[23]=[e("i",{class:"fas fa-trash text-xs"},null,-1)]),8,ue)]))),128))])])):m("",!0),e("div",null,[t[28]||(t[28]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4 pb-2 border-b border-gray-200"},"Add New Evidence",-1)),e("div",ce,[e("div",ge,[e("div",fe,[e("label",be,[t[25]||(t[25]=e("span",null,"Upload additional files",-1)),e("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",multiple:"",onChange:A},null,32)]),t[26]||(t[26]=e("p",{class:"pl-1"},"or drag and drop",-1))]),t[27]||(t[27]=e("p",{class:"text-xs text-gray-500"}," PNG, JPG, MP4 up to 10MB ",-1))])])])]),e("div",ye,[e("button",{type:"button",onClick:E,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 mr-3"}," Reset Changes "),e("button",{type:"submit",disabled:s.processing,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-75"},[s.processing?(d(),i("i",xe)):(d(),i("i",ve)),p(" "+a(s.processing?"Saving...":"Save Changes"),1)],8,pe)])],32)])])]),_:1}))}};export{Ue as default};
