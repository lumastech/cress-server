import{r as o,h as R,i as W,c as q,o as u,w as f,b as _,a as e,u as I,j as Q,k as b,v as $,l as M,d as c,F as V,g as j,n as k,f as r,e as B,t as i,m as G,W as C}from"./app-DUy5hM89.js";import{_ as J}from"./Modal-DSS9I96Z.js";import{_ as K}from"./ConfirmationModal-Dgu0hkMC.js";import{_ as X}from"./DashLayout-C8ZDk2gm.js";import"./logo-CL_3b9da.js";const Y={class:"bg-white rounded-lg shadow overflow-hidden container mx-auto"},Z={class:"p-4 border-b border-gray-200 flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-3 sm:space-y-0"},ee={class:"max-w-2xl flex space-x-4 w-full sm:w-auto"},te={class:"overflow-x-auto"},se={class:"min-w-full divide-y divide-gray-200"},le={class:"bg-gray-50"},ae=["onClick"],oe={class:"flex items-center"},re={key:0,class:"ml-1"},ne={class:"bg-white divide-y divide-gray-200"},ie={key:0},de=["colspan"],ue={key:1},ce=["colspan"],me={class:"px-6 py-4 whitespace-nowrap"},pe={class:"text-sm font-medium text-gray-900"},fe={class:"text-sm text-gray-500"},ve={class:"px-6 py-4 whitespace-nowrap"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ye=["href"],be={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},we=["onClick"],he=["onClick"],_e={class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6 flex flex-col sm:flex-row items-center justify-between"},ke={class:"hidden sm:block text-sm text-gray-700 mb-3 sm:mb-0"},Ce={class:"font-medium"},Ae={class:"font-medium"},Se={class:"font-medium"},De={class:"flex-1 flex justify-between sm:justify-end space-x-3"},$e=["disabled"],Me=["disabled"],Ve={class:"p-6"},je={class:"space-y-4"},Be={class:"mt-6 flex justify-end space-x-3"},Pe={__name:"index",props:{initialAlerts:{type:Object,default:()=>({data:[],loading:!0})},filters:{type:Object,default:()=>({status:"",search:""})}},setup(E){const w=E,h=[{label:"User",key:"name",sortable:!0},{label:"Status",key:"status",sortable:!0},{label:"Initiated",key:"initiated_at",sortable:!0},{label:"Location",key:"lat",sortable:!1}],l=o({...w.initialAlerts,loading:!1}),v=o(w.filters.status),g=o(w.filters.search),x=o("initiated_at"),m=o("desc"),p=o(!1),y=o(!1),n=o(null),A=o(null),d=async()=>{l.value.loading=!0;try{C.get("alerts",{status:v.value,search:g.value,sort:x.value,direction:m.value,page:l.value.current_page},{preserveState:!0,replace:!0,onSuccess:a=>{l.value=a.props.alerts},onError:a=>{console.error("Error fetching alerts:",a)}})}finally{l.value.loading=!1}};let S=null;const L=()=>{clearTimeout(S),S=setTimeout(d,500)},T=a=>{x.value===a?m.value=m.value==="asc"?"desc":"asc":(x.value=a,m.value="asc"),d()},N=()=>{l.value.next_page_url&&(l.value.current_page++,d())},U=()=>{l.value.prev_page_url&&(l.value.current_page--,d())},P=a=>{n.value={...a},p.value=!0},F=async()=>{try{await C.put(route("alerts.update",n.value.id),{status:n.value.status,message:n.value.message}),p.value=!1,d()}catch(a){console.error("Error updating alert:",a)}},z=a=>{A.value=a,y.value=!0},H=async()=>{try{await C.delete(route("alerts.destroy",A.value.id)),y.value=!1,d()}catch(a){console.error("Error deleting alert:",a)}},O=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return R([v,g],()=>{l.value.current_page=1,L()}),W(()=>{l.value.data.length===0&&d()}),(a,t)=>(u(),q(X,null,{default:f(()=>[_(I(Q),{title:"Health Centers"}),t[25]||(t[25]=e("nav",{class:"text-sm font-semibold mb-6","aria-label":"Breadcrumb"},[e("ol",{class:"list-none p-0 inline-flex"},[e("li",{class:"flex items-center text-blue-500"},[e("a",{href:"#",class:"text-gray-700"},"Home"),e("svg",{class:"fill-current w-3 h-3 mx-3",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512"},[e("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"})])]),e("li",{class:"flex items-center"},[e("a",{href:"#",class:"text-gray-600"},"Alerts")])])],-1)),e("div",Y,[e("div",Z,[t[8]||(t[8]=e("h2",{class:"text-lg font-medium text-gray-800"},"Alerts Management",-1)),e("div",ee,[b(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),class:"block w-full sm:w-40 rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm"},t[7]||(t[7]=[e("option",{value:""},"All Statuses",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"resolved"},"Resolved",-1)]),512),[[$,v.value]]),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),type:"text",placeholder:"Search alerts...",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm"},null,512),[[M,g.value]])])]),e("div",te,[e("table",se,[e("thead",le,[e("tr",null,[(u(),c(V,null,j(h,s=>e("th",{key:s.key,scope:"col",class:k(["px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",{"hover:text-teal-600":s.sortable}]),onClick:D=>s.sortable?T(s.key):null},[e("div",oe,[r(i(s.label)+" ",1),x.value===s.key?(u(),c("span",re,[e("i",{class:k(m.value==="asc"?"fas fa-arrow-up":"fas fa-arrow-down")},null,2)])):B("",!0)])],10,ae)),64)),t[9]||(t[9]=e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",ne,[l.value.loading?(u(),c("tr",ie,[e("td",{colspan:h.length+1,class:"px-6 py-4 text-center text-gray-500"},t[10]||(t[10]=[e("i",{class:"fas fa-circle-notch fa-spin mr-2"},null,-1),r(" Loading alerts... ")]),8,de)])):l.value.data.length===0?(u(),c("tr",ue,[e("td",{colspan:h.length+1,class:"px-6 py-4 text-center text-gray-500"}," No alerts found ",8,ce)])):B("",!0),(u(!0),c(V,null,j(l.value.data,s=>(u(),c("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",me,[e("div",pe,i(s.name),1),e("div",fe,i(s.email),1)]),e("td",ve,[e("span",{class:k(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-yellow-100 text-yellow-800":s.status==="pending","bg-red-100 text-red-800":s.status==="active","bg-green-100 text-green-800":s.status==="resolved"}])},i(s.status),3)]),e("td",ge,i(O(s.initiated_at)),1),e("td",xe,[e("a",{href:`https://maps.google.com/?q=${s.lat},${s.lng}`,target:"_blank",class:"text-teal-600 hover:text-teal-900 hover:underline"}," View Map ",8,ye)]),e("td",be,[e("button",{onClick:D=>P(s),class:"text-teal-600 hover:text-teal-900 mr-3"},t[11]||(t[11]=[e("i",{class:"fas fa-edit"},null,-1)]),8,we),e("button",{onClick:D=>z(s),class:"text-red-600 hover:text-red-900"},t[12]||(t[12]=[e("i",{class:"fas fa-trash"},null,-1)]),8,he)])]))),128))])])]),e("div",_e,[e("div",ke,[t[13]||(t[13]=r(" Showing ")),e("span",Ce,i(l.value.from),1),t[14]||(t[14]=r(" to ")),e("span",Ae,i(l.value.to),1),t[15]||(t[15]=r(" of ")),e("span",Se,i(l.value.total),1),t[16]||(t[16]=r(" alerts "))]),e("div",De,[e("button",{onClick:U,disabled:!l.value.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,$e),e("button",{onClick:N,disabled:!l.value.next_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Me)])]),_(J,{show:p.value,onClose:t[5]||(t[5]=s=>p.value=!1)},{default:f(()=>[e("div",Ve,[t[21]||(t[21]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Alert",-1)),e("form",{onSubmit:G(F,["prevent"])},[e("div",je,[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),b(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.status=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500"},t[17]||(t[17]=[e("option",{value:"pending"},"Pending",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"resolved"},"Resolved",-1)]),512),[[$,n.value.status]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Message",-1)),b(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.message=s),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500"},null,512),[[M,n.value.message]])])]),e("div",Be,[e("button",{type:"button",onClick:t[4]||(t[4]=s=>p.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),t[20]||(t[20]=e("button",{type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500"}," Save Changes ",-1))])],32)])]),_:1},8,["show"]),_(K,{show:y.value,onClose:t[6]||(t[6]=s=>y.value=!1),onConfirm:H},{title:f(()=>t[22]||(t[22]=[r(" Delete Alert ")])),content:f(()=>t[23]||(t[23]=[r(" Are you sure you want to delete this alert? This action cannot be undone. ")])),confirmButton:f(()=>t[24]||(t[24]=[r(" Delete Alert ")])),_:1},8,["show"])])]),_:1}))}};export{Pe as default};
